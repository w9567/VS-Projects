webpackJsonp([6],{"8MNQ":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),n=s("BO1k"),r=s.n(n),o=s("4ZRF"),l=s("WheD"),c={data:function(){return{article:[],textarea:"",islogin:!1,comments:[],commentList:[],username:"",tags:[]}},name:"contents",components:{Header:o.a,Footer:l.a},methods:{tologin:function(){this.$router.push({path:"/login"})},refer:function(){var t=this;if(this.textarea.length<1)this.$message({message:"评论不能为空",type:"warning"});else{var e=this.username,s=(new Date).getTime();if(this.commentList.length>0){var i=!0,n=!1,o=void 0;try{for(var l,c=r()(this.commentList);!(i=(l=c.next()).done);i=!0){var m=l.value;this.comments.push(m)}}catch(t){n=!0,o=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw o}}}this.comments.push({username:e,comment:this.textarea,postTime:s}),this.axios.post("/api/insertComments",{comments:a()(this.comments),id:this.article.id}).then(function(i){1==i.data.status?(t.commentList.push({username:e,comment:t.textarea,postTime:s}),t.textarea=""):t.$message.error(i.data.msg)}).catch(function(e){t.$message.error("服务器错误"),console.log(e)})}}},mounted:function(){var t=this;this.username=sessionStorage.getItem("username")||"",this.username.length>0&&(this.islogin=!0),this.article=this.$route.query.article;var e=this.article.type.substring(1,this.article.type.length-1).replace(/\"/g,"");this.tags=e.split(","),this.commentList=JSON.parse(this.article.comments)||[],this.axios.post("/api/updateCount",{view:this.article.view+1,count:this.commentList.length,id:this.article.id}).then(function(t){}).catch(function(e){t.$message.error("服务器错误"),console.log(e)})}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("article",[s("Header"),t._v(" "),s("section",{staticClass:"blog-body"},[s("div",{staticClass:"detail"},[s("h1",{staticClass:"detail-title"},[t._v(t._s(t.article.title))]),t._v(" "),s("div",{staticClass:"detail-content"},[s("p",{domProps:{innerHTML:t._s(t.article.shtml)}})]),t._v(" "),s("p",{staticClass:"detail-tags"}),t._v(" "),s("div",{staticClass:"detail-admin"},[s("p",[t._v("发布于 "+t._s(t._f("formatDate")(t.article.post_time,"yyyy-MM-dd")))]),t._v(" "),s("p",[t._v("浏览"+t._s(t.article.view)+"次")])]),t._v(" "),s("div",[t._l(t.tags,function(e,i){return s("el-tag",{key:i,staticStyle:{border:"none","margin-right":"10px"},attrs:{type:"info"}},[t._v(t._s(e))])}),t._v(" "),s("div",{staticClass:"blog-comment"},[s("div",{staticClass:"comment-list"},[s("ul",t._l(t.commentList,function(e){return s("li",{key:e.postTime},[s("div",{staticClass:"list-header clearfix"},[s("div",{staticClass:"header-reply"},[s("span",[t._v(t._s(e.username))])]),t._v(" "),s("span",{staticClass:"header-time"},[t._v(t._s(t._f("formatDate")(e.postTime,"yyyy-MM-dd")))])]),t._v(" "),s("div",{staticClass:"list-content"},[s("p",[t._v(t._s(e.comment))])])])}),0)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.islogin,expression:"islogin==true"}],staticStyle:{"margin-top":"10px"}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),t._v(" "),s("el-button",{staticStyle:{"margin-top":"10px","margin-left":"89%"},attrs:{type:"primary",size:"small",plain:""},on:{click:t.refer}},[t._v("提交留言")])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.islogin,expression:"islogin==false"}],staticClass:"comment-unlogin"},[s("el-button",{attrs:{type:"primary"},on:{click:t.tologin}},[t._v("登录")]),t._v(" "),s("p",[t._v("欢迎留言交流")])],1)])],2)])]),t._v(" "),s("Footer")],1)},staticRenderFns:[]};var v=s("VU/8")(c,m,!1,function(t){s("sD38")},"data-v-5dd481c4",null);e.default=v.exports},sD38:function(t,e){}});
//# sourceMappingURL=6.558a24c72046ca4ecd51.js.map