{"version":3,"sources":["webpack:///src/components/admin/Update.vue","webpack:///./src/components/admin/Update.vue?ff9e","webpack:///./src/components/admin/Update.vue"],"names":["Update","data","title","editorContent","draft","context","toolbars","bold","italic","header","underline","mark","superscript","quote","ol","link","imagelink","help","code","subfield","fullscreen","readmodel","undo","trash","save","navigation","options","tags","username","methods","publish","_this","this","length","$message","message","type","axios","post","id","content","stringify_default","state","then","response","status","$router","push","path","error","catch","console","log","$imgAdd","pos","$file","_this2","formdata","FormData","append","url","method","$refs","md","$img2Url","saveArticle","_this3","mounted","_this4","$route","query","summary","sessionStorage","getItem","get","admin_Update","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","placeholder","model","value","callback","$$v","expression","_v","staticStyle","text-align","ref","on","imgAdd","margin-bottom","span","width","multiple","popper-append-to-body","_l","item","key","label","name","offset","size","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/9.6418c4c5e905861fac62.js","sourcesContent":["<template>\r\n  <section class=\"blog-body\">\r\n    <div class=\"admin-publish\">\r\n      <el-input v-model=\"title\" placeholder=\"文章标题\"></el-input>\r\n      <div id=\"editor\" style=\"text-align:left\"></div>\r\n      <mavon-editor\r\n        v-model=\"context\"\r\n        :toolbars=\"toolbars\"\r\n        @imgAdd=\"$imgAdd\"\r\n        class=\"blogcontent\"\r\n        ref=\"md\"\r\n      />\r\n      <el-row style=\"margin-bottom:20px\">\r\n        <el-col :span=\"16\">\r\n          <el-select\r\n            v-model=\"tags\"\r\n            multiple\r\n            :popper-append-to-body=\"false\"\r\n            placeholder=\"请选择标签\"\r\n            style=\"width:100%\"\r\n          >\r\n            <el-option v-for=\"item in options\" :key=\"item.id\" :label=\"item.name\" :value=\"item.name\"></el-option>\r\n          </el-select>\r\n        </el-col>\r\n        <el-col :span=\"6\" :offset=\"2\">\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"saveArticle\">存为草稿</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"publish\">发布</el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n  </section>\r\n</template>\r\n<script>\r\n// import mavonEditor from 'mavon-editor'\r\n// import 'mavon-editor/dist/css/index.css'\r\nexport default {\r\n  data() {\r\n    return {\r\n      title: \"\",\r\n      editorContent: \"\",\r\n      draft: [],\r\n      context: \"\", //输入的数据\r\n      toolbars: {\r\n        bold: true, // 粗体\r\n        italic: true, // 斜体\r\n        header: true, // 标题\r\n        underline: true, // 下划线\r\n        mark: true, // 标记\r\n        superscript: true, // 上角标\r\n        quote: true, // 引用\r\n        ol: true, // 有序列表\r\n        link: true, // 链接\r\n        imagelink: true, // 图片链接\r\n        help: true, // 帮助\r\n        code: true, // code\r\n        subfield: true, // 是否需要分栏\r\n        fullscreen: true, // 全屏编辑\r\n        readmodel: true, // 沉浸式阅读\r\n        undo: true, // 上一步\r\n        trash: true, // 清空\r\n        save: true, // 保存（触发events中的save事件）\r\n        navigation: true // 导航目录\r\n      },\r\n      options: [],\r\n      tags: [],\r\n      username: \"\"\r\n    };\r\n  },\r\n  methods: {\r\n    publish() {\r\n      if (this.title.length < 1) {\r\n        this.$message({\r\n          message: \"标题不能为空\",\r\n          type: \"warning\"\r\n        });\r\n      } else if (this.context.length < 1) {\r\n        this.$message({\r\n          message: \"内容不能为空\",\r\n          type: \"warning\"\r\n        });\r\n      } else if (this.tags.length < 1) {\r\n        this.$message({\r\n          message: \"请选择标签\",\r\n          type: \"warning\"\r\n        });\r\n      } else {\r\n        this.axios\r\n          .post(\"/api/admin/updArticle\", {\r\n            id: this.draft.id,\r\n            title: this.title,\r\n            content: this.context,\r\n            tags: JSON.stringify(this.tags),\r\n            state: 1\r\n          })\r\n          .then(response => {\r\n            if (response.data.status == true) {\r\n              this.$message({\r\n                message: \"修改成功\",\r\n                type: \"success\"\r\n              });\r\n              this.$router.push({ path: \"/admin/settings\" });\r\n            } else if (response.data.status == false) {\r\n              this.$message.error(\"修改失败\");\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.log(error);\r\n          });\r\n      }\r\n    },\r\n    $imgAdd(pos, $file) {\r\n      // 第一步.将图片上传到服务器.\r\n      var formdata = new FormData();\r\n      formdata.append(\"imgFile\", $file);\r\n      this.axios({\r\n        url: \"/api/uploadImg\",\r\n        method: \"post\",\r\n        data: formdata\r\n        // headers: { \"Content-Type\": \"multipart/form-data\" }\r\n      }).then(response => {\r\n        console.log(response);\r\n        // 第二步.将返回的url替换到文本原位置![...](0) -> ![...](url)\r\n        /**\r\n         * $vm 指为mavonEditor实例，可以通过如下两种方式获取\r\n         * 1. 通过引入对象获取: `import {mavonEditor} from ...` 等方式引入后，`$vm`为`mavonEditor`\r\n         * 2. 通过$refs获取: html声明ref : `<mavon-editor ref=md ></mavon-editor>，`$vm`为 `this.$refs.md`\r\n         */\r\n        this.$refs.md.$img2Url(pos, response.data.url);\r\n      });\r\n    },\r\n    saveArticle() {\r\n      if (this.title.length < 1) {\r\n        this.$message({\r\n          message: \"标题不能为空\",\r\n          type: \"warning\"\r\n        });\r\n      } else if (this.context.length < 1) {\r\n        this.$message({\r\n          message: \"内容不能为空\",\r\n          type: \"warning\"\r\n        });\r\n      } else if (this.tags.length < 1) {\r\n        this.$message({\r\n          message: \"请选择标签\",\r\n          type: \"warning\"\r\n        });\r\n      } else {\r\n        this.axios\r\n          .post(\"/api/admin/updArticle\", {\r\n            id:this.draft.id,\r\n            username: this.username,\r\n            title: this.title,\r\n            content: this.context,\r\n            tags: JSON.stringify(this.tags),\r\n            state: 0\r\n          })\r\n          .then(response => {\r\n            if (response.data.status == true) {\r\n              this.$message({\r\n                message: \"保存成功\",\r\n                type: \"success\"\r\n              });\r\n              this.$router.push({ path: \"/admin/settings\" });\r\n            } else if (response.data.status == false) {\r\n              this.$message.error(\"保存失败\");\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.log(error);\r\n          });\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    //初始化数据\r\n    this.draft = this.$route.query.draft;\r\n    this.title = this.draft.title;\r\n    this.context = this.draft.summary;\r\n    this.username = sessionStorage.getItem(\"username\");\r\n    this.axios\r\n      .get(\"/api/admin/getTagAll\")\r\n      .then(response => {\r\n        let data = response.data;\r\n        this.options = data;\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n      });\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.blogcontent {\r\n  height: 400px;\r\n  margin-top: 20px;\r\n  margin-bottom: 20px;\r\n}\r\nspan {\r\n  margin-right: 5px;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/admin/Update.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"blog-body\"},[_c('div',{staticClass:\"admin-publish\"},[_c('el-input',{attrs:{\"placeholder\":\"文章标题\"},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}}),_vm._v(\" \"),_c('div',{staticStyle:{\"text-align\":\"left\"},attrs:{\"id\":\"editor\"}}),_vm._v(\" \"),_c('mavon-editor',{ref:\"md\",staticClass:\"blogcontent\",attrs:{\"toolbars\":_vm.toolbars},on:{\"imgAdd\":_vm.$imgAdd},model:{value:(_vm.context),callback:function ($$v) {_vm.context=$$v},expression:\"context\"}}),_vm._v(\" \"),_c('el-row',{staticStyle:{\"margin-bottom\":\"20px\"}},[_c('el-col',{attrs:{\"span\":16}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"multiple\":\"\",\"popper-append-to-body\":false,\"placeholder\":\"请选择标签\"},model:{value:(_vm.tags),callback:function ($$v) {_vm.tags=$$v},expression:\"tags\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.name}})}),1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":6,\"offset\":2}},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.saveArticle}},[_vm._v(\"存为草稿\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.publish}},[_vm._v(\"发布\")])],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3a36d009\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/admin/Update.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3a36d009\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Update.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Update.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Update.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3a36d009\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Update.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-3a36d009\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/admin/Update.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}